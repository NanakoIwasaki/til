name: Create Tomorrow's TIL File

on:
  schedule:
    - cron: '0 0 * * *'  # UTCで0時、日本時間9時に実行
  workflow_dispatch:  # 手動でも実行できるように

jobs:
  create-til:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3

      - name: Set up Git
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "41898282+github-actions[bot]@users.noreply.github.com"

      - name: Create Tomorrow's TIL file
        run: |
          DATE=$(date -u -d "+9 hours +1 day" +'%Y-%m-%d')
          YEAR_MONTH=$(echo $DATE | cut -c 1-7)
          FILE_PATH="$YEAR_MONTH/$DATE.md"

          mkdir -p "$YEAR_MONTH"
          if [ ! -f "$FILE_PATH" ]; then
            echo "## $DATE TIL\n\n### 今日やったこと\n- [ ]\n\n### 今日学んだこと\n-\n\n### 気付き\n>\n\n### 次にやること\n- [ ]" > "$FILE_PATH"
            git add "$FILE_PATH"
            git commit -m "Add TIL template for $DATE"
            git push
          fi